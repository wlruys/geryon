profiles:
  local_fast:
    env_script: ./env/bootstrap.sh
    env_setup_cmds:
      - export OMP_NUM_THREADS=4
    env:
      DATA_ROOT: /scratch/data
    defaults:
      run_local:
        executor: process
        max_concurrent_tasks: 4
        cores_per_task: 1
        max_retries: 1
        retry_on_status: [failed, terminated]
        resume: true
        progress: true

  a100_short:
    partition: gpu
    time_min: 240
    cpus_per_task: 8
    mem_gb: 64
    gpus_per_node: 1
    mail_user: you@example.org
    mail_type: END,FAIL
    env_script: ./env/bootstrap.sh
    env_setup_cmds:
      - export OMP_NUM_THREADS=8
    slurm_setup_cmds:
      - module load cuda/12.2
    slurm_additional_parameters:
      account: my_project
      qos: normal
      constraint: a100
      exclusive: true
    defaults:
      run_slurm:
        executor: tmux
        max_concurrent_tasks: 2
        cores_per_task: 4
        batches_per_task: 2
        resume: true
        query_status: true
        slurm_setup_cmds:
          - module load cuda/12.2
        sbatch_option:
          qos: normal
          constraint: a100
